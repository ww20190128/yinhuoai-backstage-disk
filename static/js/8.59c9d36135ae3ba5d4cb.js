webpackJsonp([8],{"Bm/p":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Dd8w"),n=s.n(i),a=s("xipm"),l=s("X2Oc"),r=s("NYxO"),o={data:function(){return{collapse:!1,fullscreen:!1,loginUserInfo:l.a.store.get("loginUser"),messageVisible:!1,exportVisible:!1,receiver:"",remark:"",exemption:0,exportInfo:{}}},methods:{handleCommand:function(e){switch(e){case"loginOut":l.a.store.clear("loginUser"),l.a.store.clear("loginKey"),this.$router.push("/login");break;case"userInfo":this.$router.push("/user/Info")}},handleCollapse:function(){this.collapse=!this.collapse,a.a.$emit("collapse",this.collapse)},handleFullScreen:function(){var e=document.documentElement;this.fullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},handleScreenStatus:function(){var e=this;document.addEventListener("fullscreenchange",function(){e.fullscreen=!e.fullscreen}),document.addEventListener("mozfullscreenchange",function(){e.fullscreen=!e.fullscreen}),document.addEventListener("webkitfullscreenchange",function(){e.fullscreen=!e.fullscreen}),document.addEventListener("msfullscreenchange",function(){e.fullscreen=!e.fullscreen})},hideMessage:function(){this.messageVisible=!1},goToNews:function(e){this.$router.push({path:"/news/list",query:{tabType:e}}),this.messageVisible=!1},markAllAsRead:function(){},markAsRead:function(e){}},computed:n()({envName:function(){return"prod"===l.a.env?"正式版":"test"===l.a.env?"测试版":"开发版"}},Object(r.c)(["currentUser","unread","selectItems"])),mounted:function(){var e=this;this.loginUserInfo=l.a.store.get("loginUser"),setTimeout(function(){e.handleScreenStatus()})},created:function(){this.currentUser.user||this.$router.push("/login")}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[s("div",{staticClass:"collapse-btn",on:{click:e.handleCollapse}},[s("i",{staticClass:"el-icon-menu"})]),e._v(" "),s("div",{staticClass:"title-wrapper"},[e._v("\n    因火AI\n    "),s("span",{staticClass:"project"},[e._v("\n      / 管理系统\n    ")]),e._v(" "),s("el-tag",{attrs:{effect:"plain",type:"info",size:"mini"}},[e._v(e._s(e.envName))])],1),e._v(" "),s("div",{staticClass:"header-right"},[s("div",{staticClass:"user-icon"},[s("div",{staticClass:"btn-fullscreen",on:{click:e.handleFullScreen}},[s("el-tooltip",{attrs:{effect:"dark",content:e.fullscreen?"取消全屏":"全屏",placement:"bottom"}},[s("i",{staticClass:"el-icon-rank"})])],1),e._v(" "),s("div",{staticClass:"btn-bell",on:{click:function(t){t.stopPropagation(),e.messageVisible=!e.messageVisible}}},[s("el-tooltip",{attrs:{effect:"dark",content:e.unread.totalNum>0?"您有"+e.unread.totalNum+"条未读消息":"新的消息",placement:"bottom"}},[s("i",{staticClass:"el-icon-bell"})]),e._v(" "),e.unread.totalNum>0?s("span",{staticClass:"btn-bell-num"},[e._v(e._s(e.unread.totalNum))]):e._e()],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.messageVisible,expression:"messageVisible"}],staticClass:"notifications-box",on:{click:function(e){e.stopPropagation()}}},[s("div",{staticClass:"title"},[s("div",[e._v("消息")]),e._v(" "),e.unread.totalNum>0?s("div",{staticClass:"read",on:{click:e.markAllAsRead}},[s("i",{staticClass:"el-icon-check"}),e._v("\n            全部标记为已读\n          ")]):e._e()]),e._v(" "),s("div",{staticClass:"detail"},[e.unread.totalNum>0?s("div",{staticClass:"detail-list"},[e._l(e.unread.list,function(t,i){return s("div",{key:i,staticClass:"detail-sigle",on:{click:function(t){return e.goToNews("unread")}}},[s("div",{staticClass:"detail-sigle-left"},[s("div",[e._v(e._s(t.title))]),e._v(" "),s("div",{attrs:{title:t.content}},[e._v(e._s(t.content))]),e._v(" "),s("div",[e._v(e._s(e._f("formatTime")(1e3*t.createTime)))])]),e._v(" "),s("div",{staticClass:"detail-sigle-right"},[s("div",{attrs:{title:"标记为已读"},on:{click:function(s){return s.stopPropagation(),e.markAsRead(t.id)}}},[s("i",{staticClass:"el-icon-check"})])])])}),e._v(" "),e.unread.totalNum>3?s("div",{staticClass:"detail-more",on:{click:function(t){return e.goToNews("unread")}}},[e._v("查看更多未读消息")]):e._e()],2):s("div",{staticClass:"no-detail"},[e._v("-没有新消息-")])]),e._v(" "),s("div",{staticClass:"bottom",on:{click:function(t){return e.goToNews("all")}}},[e._v("查看全部消息")])]),e._v(" "),e.currentUser.user.icon?s("div",{staticClass:"user-avator"},[s("img",{attrs:{src:e.currentUser.user.icon}})]):e._e(),e._v(" "),s("el-dropdown",{staticClass:"userName",attrs:{trigger:"click"},on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[e._v("\n          "+e._s(e.loginUserInfo&&e.loginUserInfo.user.userName?e.loginUserInfo.user.userName:"未登陆")+"\n          "),s("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"userInfo"}},[e._v("账号信息")]),e._v(" "),s("el-dropdown-item",{attrs:{divided:"",command:"loginOut"}},[e._v("退出登录")])],1)],1)],1)])])},staticRenderFns:[]};var u=s("VU/8")(o,c,!1,function(e){s("npGG")},"data-v-57bce8d6",null).exports,d=s("t5k4"),m={mounted:function(){},data:function(){return{collapse:!1,items:d.a.sidebar}},computed:n()({},Object(r.c)(["currentUser"]),{onRoutes:function(){return this.$route.path}}),created:function(){var e=this;a.a.$on("collapse",function(t){e.collapse=t})},methods:{}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sidebar"},[s("el-menu",{staticClass:"sidebar-el-menu",attrs:{"default-active":e.onRoutes,collapse:e.collapse,"background-color":"#2c435c","text-color":"#ffffff","active-text-color":"#20a0ff","unique-opened":"",router:""}},[e._l(e.items,function(t){return[s("div",{directives:[{name:"show",rawName:"v-show",value:(!t.privilegeName||e.currentUser.havePrivilege.showControl[t.privilegeName])&&(!t.projectType||t.projectType==e.currentUser.user.projectType),expression:"\n          (!item.privilegeName ||\n          currentUser.havePrivilege.showControl[item.privilegeName]) &&\n          (!item.projectType || item.projectType == currentUser.user.projectType)\n        "}]},[t.subs?[s("el-submenu",{key:t.index,attrs:{index:t.index}},[s("template",{slot:"title"},[s("i",{class:t.icon}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]),e._v(" "),e._l(t.subs,function(t){return[t.privilegeName&&!e.currentUser.havePrivilege.showControl[t.privilegeName]||t.projectType&&t.projectType!=e.currentUser.user.projectType?e._e():s("div",[t.subs?s("el-submenu",{key:t.index,attrs:{index:t.index}},[s("template",{slot:"title"},[t.icon?s("i",{class:t.icon}):e._e(),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]),e._v(" "),e._l(t.subs,function(t,i){return[t.privilegeName&&!e.currentUser.havePrivilege.opControl[t.privilegeName]&&!e.currentUser.havePrivilege.showControl[t.privilegeName]||t.projectType&&t.projectType!=e.currentUser.user.projectType?e._e():s("div",[t.subs?s("el-submenu",{key:t.index,attrs:{index:t.index}},[s("template",{slot:"title"},[t.icon?s("i",{class:t.icon}):e._e(),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]),e._v(" "),e._l(t.subs,function(t,i){return s("el-menu-item",{key:i,attrs:{index:t.index}},[e._v(e._s(t.title)+"\n                        ")])})],2):s("el-menu-item",{key:t.index,attrs:{index:t.index}},[e._v(e._s(t.title)+"\n                      ")])],1)]})],2):s("el-menu-item",{key:t.index,attrs:{index:t.index}},[e._v(e._s(t.title)+"\n                ")])],1)]})],2)]:[s("el-menu-item",{key:t.index,attrs:{index:t.index}},[s("i",{class:t.icon}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]],2)]})],2)],1)},staticRenderFns:[]};var h={data:function(){return{tagsList:[]}},methods:{isActive:function(e){return e===(!(!this.$route.query||!this.$route.query.multiple||"true"!=this.$route.query.multiple.toString())?this.$route.meta.title+"-"+this.$route.query.multipleId:this.$route.meta.title)},closeTags:function(e){var t=this.tagsList.splice(e,1)[0],s=this.tagsList[e]?this.tagsList[e]:this.tagsList[e-1];s?t.path===this.$route.fullPath&&this.$router.push(s.path):this.$router.push("/"),a.a.$emit("tags",this.tagsList)},closeAll:function(){this.tagsList=[],this.$router.push("/"),a.a.$emit("tags",this.tagsList)},closeOther:function(){var e=this,t=this.tagsList.filter(function(t){return t.path===e.$route.fullPath});this.tagsList=t,a.a.$emit("tags",this.tagsList)},setTags:function(e){var t=0,s=!(!e.query||!e.query.multiple||"true"!=e.query.multiple.toString())?e.meta.title+"-"+e.query.multipleId:e.meta.title;this.tagsList.some(function(e,i){return e.title===s&&(t=i),e.title===s})?this.tagsList.splice(t,1,{title:s,path:e.fullPath,name:e.name?e.name:e.matched[1].components.default.name}):(this.tagsList.length>10&&this.tagsList.shift(),this.tagsList.push({title:s,path:e.fullPath,name:e.name?e.name:e.matched[1].components.default.name})),a.a.$emit("tags",this.tagsList)},handleTags:function(e){"other"===e?this.closeOther():this.closeAll()}},computed:{showTags:function(){return this.tagsList.length>0}},watch:{$route:function(e,t){this.setTags(e)}},created:function(){var e=this;this.setTags(this.$route),a.a.$on("close",function(t){for(var s=0;s<e.tagsList.length;s++)e.tagsList[s].name==t&&e.closeTags(s)})}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showTags?s("div",{staticClass:"tags"},[s("ul",e._l(e.tagsList,function(t,i){return s("li",{key:i,staticClass:"tags-li",class:{active:e.isActive(t.title)}},[s("router-link",{staticClass:"tags-li-title",attrs:{to:t.path}},[e._v(e._s(t.title))]),e._v(" "),s("span",{staticClass:"tags-li-icon",on:{click:function(t){return e.closeTags(i)}}},[s("i",{staticClass:"el-icon-close"})])],1)}),0),e._v(" "),s("div",{staticClass:"tags-close-box"},[s("el-dropdown",{on:{command:e.handleTags}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("\n        标签选项\n        "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown",size:"small"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"other"}},[e._v("关闭其他")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"all"}},[e._v("关闭所有")])],1)],1)],1)]):e._e()},staticRenderFns:[]};var f={data:function(){return{tagsList:[],collapse:!1}},components:{vHead:u,vSidebar:s("VU/8")(m,v,!1,function(e){s("ywTd")},"data-v-dde750ce",null).exports,vTags:s("VU/8")(h,p,!1,function(e){s("nMfe")},null,null).exports},methods:n()({hideMessage:function(){this.$refs.message.hideMessage()},init:function(){this.getSelectItem(),this.getPrivileges(),this.getUnreadList(),this.syncUnreadList(),this.handleMobile()},syncUnreadList:function(){var e=this,t=setInterval(function(){e.getUnreadList()},6e4);this.$once("hook:beforeDestroy",function(){clearInterval(t),t=null})},handleMobile:function(){document.body.clientWidth<=750&&this.$router.replace({path:"/news/list",query:{tabType:"unread"}})}},Object(r.b)(["getSelectItem","getPrivileges","getUnreadList"])),created:function(){var e=this;this.init(),a.a.$on("collapse",function(t){e.collapse=t}),a.a.$on("tags",function(t){for(var s=[],i=0,n=t.length;i<n;i++)t[i].name&&s.push(t[i].name);e.tagsList=s}),window.addEventListener("resize",function(){a.a.$emit("resize")})}},g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"wrapper",on:{click:this.hideMessage}},[t("v-head",{ref:"message"}),this._v(" "),t("v-sidebar"),this._v(" "),t("div",{staticClass:"content-box",class:{"content-collapse":this.collapse}},[t("v-tags"),this._v(" "),t("div",{staticClass:"content"},[t("transition",{attrs:{name:"move",mode:"out-in"}},[t("keep-alive",{attrs:{include:this.tagsList}},[t("router-view")],1)],1)],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(f,g,!1,function(e){s("HaUP")},"data-v-70e13df6",null);t.default=_.exports},HaUP:function(e,t){},nMfe:function(e,t){},npGG:function(e,t){},ywTd:function(e,t){}});